<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>slides-now-core test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="author" content="Gleb Bahmutov">
    <link rel="stylesheet" href="http://code.jquery.com/qunit/qunit-1.14.0.css">
    <link rel="stylesheet" href="bower_components/code-box.css">
    <link rel="stylesheet" href="slides-now-core.css">
    <style>
      .bespoke-inactive {
        display: none;
      }
      .bespoke-slide {
        border: 1px solid black;
        border-radius: 4px;
        padding: 0;
        width: 800px;
        height: 600px;
        margin: auto;
      }
      .bespoke-slide > span > * {
        padding-left: 20px;
      }
      .bespoke-slide > img {
        width: 100%;
        height: 100%;
      }
      .bespoke-slide span.fullscreen-caption {
        position: relative;
        top: -2em;
        left: 0;
        padding-top: 0.5em;
        padding-left: 0.75em;
        padding-right: 2em;
        font-size: 32pt;
        display: inline-block;
        background-image: -webkit-gradient(
          linear,
          left center, right center,
          from(rgba(255,255,255,1.0)),
          to(rgba(0,0,0,0)),
          color-stop(.8,rgba(255,255,255,1.0))
        );
      }
      
    </style>
    <script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
    <script src="http://code.jquery.com/qunit/qunit-1.14.0.js"></script>
    <script src="bower_components/es5-shim.js"></script>
    <script src="bower_components/bespoke.js"></script>
    <script src="bower_components/bespoke-hash.js"></script>
    <script src="bower_components/flowType.js"></script>
    <script src="bower_components/code-box.js"></script>
    <script src="slides-now-core.js"></script>
    <script>
      $(function () {
        QUnit.module('generated example presentation');
        
        QUnit.test('it is a function', function () {
          QUnit.equal(typeof window.mdToPresentation, 'function');
        });
        
        var md = document.getElementById('md').innerHTML;
        mdToPresentation({
          md: md,
          filename: 'example',
          element: $('#presentation')
        });
        
        QUnit.test('number of slides', function () {
          var slides = $('#presentation > article > section');
          QUnit.equal(slides.length, 4, 'number of slides');
        });
        
        QUnit.test('title', function () {
          var title = $('#presentation > article > section h1').text();
          QUnit.equal(title, 'slides-now-core', 'correct title');
        });
        
        QUnit.test('one slide should be active', function () {
          var active = $('section.bespoke-active');
          QUnit.equal(active.length, 1, 'probably first slide');
        });
        
        QUnit.module('postProcessSlide');
        
        QUnit.test('basics', function () {
          QUnit.equal(typeof window.postProcessSlide, 'function', 'it is a function');
        });
        
        QUnit.test('fullscreen image inside a slide', function () {
          var html = '<section class="bespoke-slide bespoke-active">\n' +
            '<p><img src="https://raw.github.com/bahmutov/talks/master/images/border.jpg" alt="slide four fullscreen"></p>\n'+
            '</section>\n';
          var $slide = $(html);
          var $img = $('p > img', $slide);
          QUnit.equal($img.length, 1, 'found image inside slide');
          var text = $img.attr('alt');
          QUnit.equal(typeof text, 'string', 'found alt text');
          QUnit.equal(text, 'slide four fullscreen', 'correct alt text');
          
          $slide = postProcessSlide($slide);
          QUnit.equal(typeof $slide, 'object', 'returns an object');
          
          var caption = $('span', $slide).text();
          QUnit.equal(caption, 'slide four', 'correct caption from image alt text');
        });
      });
      
    </script>
  </head>
  <body>
    <div id="qunit"></div>
    <div id="qunit-fixture"></div>
    <div id="presentation"></div>
    <p id="md" style="display:none;"># slides-now-core

this is slide 1

## two

this is slide 2

## three

this is slide 3

---
![slide four fullscreen](https://raw.github.com/bahmutov/talks/master/images/border.jpg)

    </p>
  </body>
</html>